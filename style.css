:root {
    --glass: rgba(255, 255, 255, 0.1);
    --glass-border: rgba(255, 255, 255, 0.2);
    --text: #ffffff;
    --accent: #ff4d4d;
    --handwritten: 'Indie Flower', cursive;
    --spotify-font: 'Montserrat', sans-serif;
}
.christmas-theme { --accent: #ff4d4d; --bg: url('https://images.unsplash.com/photo-1482517967863-00e15c9b44be?q=80&w=2070'); }
.ny-theme { --accent: #d4af37; --bg: url('https://images.unsplash.com/photo-1467810563316-b5476525c0f9?q=80&w=2069'); }

body {
    margin: 0; font-family: 'Quicksand', sans-serif; color: var(--text);
    background: linear-gradient(rgba(0,0,0,0.6), rgba(0,0,0,0.6)), var(--bg) no-repeat center center fixed;
    background-size: cover; transition: background 1s; overflow-x: hidden;
}
.hidden { display: none !important; }

/* OVERLAYS */
.login-overlay, .reveal-overlay, .ny-overlay {
    position: fixed; inset: 0; z-index: 10000; display: flex; align-items: center; justify-content: center;
    background: rgba(0,0,0,0.95); backdrop-filter: blur(20px); text-align: center;
}
.stage { position: absolute; width: 100%; display: flex; flex-direction: column; align-items: center; }

/* GIFT */
.floating-gift {
    position: fixed; bottom: 30px; right: 30px; font-size: 3.5rem; cursor: pointer;
    z-index: 999; animation: bob 3s infinite ease-in-out; filter: drop-shadow(0 0 10px var(--accent));
}
@keyframes bob { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-15px); } }

/* MAIN UI */
.main-content { max-width: 1000px; margin: 0 auto; padding: 20px; position: relative; z-index: 5; }
.hero-section { text-align: center; padding: 60px 0; }
.main-title { font-family: 'Dancing Script'; font-size: clamp(2.5rem, 10vw, 5rem); }
.memory-pill { background: var(--accent); color: white; border: none; padding: 10px 25px; border-radius: 50px; cursor: pointer; font-weight: 800; margin: 5px; }

/* GLASS CARDS */
.glass-card { background: var(--glass); backdrop-filter: blur(12px); border-radius: 25px; padding: 30px; margin-bottom: 40px; border: 1px solid var(--glass-border); }
.pinned-note {
    background: rgba(255, 255, 255, 0.08); padding: 45px 30px 30px; border-radius: 20px;
    font-family: var(--handwritten); font-size: 1.8rem; margin-bottom: 30px; position: relative; border: 1px solid rgba(255,255,255,0.2);
}
.pinned-note::before { content: '❤️'; position: absolute; top: -20px; left: 50%; transform: translateX(-50%); font-size: 2rem; animation: pulse 2s infinite; }

/* BINDER */
.binder-wrapper { background: rgba(255,255,255,0.05); backdrop-filter: blur(15px); border-radius: 30px; border: 1px solid var(--glass-border); display: flex; }
.binder-spine { width: 40px; background: rgba(0,0,0,0.2); display: flex; flex-direction: column; justify-content: space-around; padding: 20px 0; border-radius: 30px 0 0 30px; }
.ring { width: 20px; height: 20px; border: 3px solid #bbb; border-radius: 50%; margin: 0 auto; }
.binder-content { flex: 1; padding: 30px; }
.song-entry { display: grid; grid-template-columns: 1.2fr 1fr; gap: 20px; background: rgba(0,0,0,0.3); padding: 20px; border-radius: 20px; margin-bottom: 30px; border: 1px solid rgba(255,255,255,0.1); }
.music-box { aspect-ratio: 1/1; border-radius: 15px; overflow: hidden; background: #000; }
.favorite-line-box { font-family: var(--spotify-font); font-weight: 900; background: var(--accent); padding: 12px; border-radius: 12px; margin-top: 10px; }

/* NY STAGES */
#star-field { position: fixed; inset: 0; pointer-events: none; }
.drifting-star { position: absolute; font-size: 2.5rem; cursor: pointer; pointer-events: auto; }
.star-msg { font-family: var(--handwritten); font-size: 1.4rem; color: #fff; background: rgba(212,175,55,0.9); padding: 10px 15px; border-radius: 15px; display: block; max-width: 200px; line-height: 1.3; }
#digital-clock { font-size: clamp(4rem, 15vw, 8rem); font-family: 'Montserrat'; font-weight: 900; }
.midnight-glow { color: #d4af37; text-shadow: 0 0 30px #d4af37; transform: scale(1.1); transition: 0.5s; }

/* ENVELOPE */
.envelope-wrapper { width: 340px; height: 240px; position: relative; perspective: 1000px; }
.envelope { width: 100%; height: 100%; background: #e3d0a5; border-radius: 0 0 10px 10px; position: relative; z-index: 5; cursor: pointer; box-shadow: 0 15px 50px rgba(0,0,0,0.6); }
.wax-seal { position: absolute; bottom: 40%; left: 50%; transform: translate(-50%, 50%); width: 50px; height: 50px; background: #b02a2a; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.5rem; z-index: 7; border: 2px solid #8a1d1d; transition: 0.3s; }
.envelope.open .wax-seal { opacity: 0; scale: 0; }
.flap { position: absolute; top: 0; width: 100%; height: 130px; background: #d4bc82; clip-path: polygon(0 0, 100% 0, 50% 100%); transform-origin: top; transition: 0.8s ease; z-index: 6; }
.envelope.open .flap { transform: rotateX(180deg); z-index: 1; }
.letter { position: absolute; bottom: 10px; left: 5%; width: 90%; height: 95%; background: #fdfaf3; padding: 30px; box-sizing: border-box; color: #2c2c2c; font-family: var(--handwritten); transition: 1s; z-index: 3; box-shadow: inset 0 0 50px rgba(220,210,190,0.5); background-image: repeating-linear-gradient(#fdfaf3, #fdfaf3 31px, #e5e5e5 31px, #e5e5e5 32px); }
.envelope.open .letter { transform: translateY(-200px); height: 400px; z-index: 10; overflow-y: auto; }
#typewriter-text { font-size: 1.3rem; line-height: 32px; white-space: pre-wrap; word-break: break-word; text-align: left; }
.letter-label { position: absolute; width: 100%; bottom: -60px; font-family: 'Dancing Script'; font-size: 1.5rem; color: #d4af37; }

@keyframes fall { to { transform: translateY(110vh) rotate(360deg); } }
@keyframes pulse { 0%, 100% { scale: 1; } 50% { scale: 1.1; } }
@media (max-width: 768px) { .song-entry { grid-template-columns: 1fr; } .mobile-hidden { display: none; } }
